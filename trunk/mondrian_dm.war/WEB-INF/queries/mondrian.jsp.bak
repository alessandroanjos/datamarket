<%@ page session="true" contentType="text/html; charset=ISO-8859-1" %>
<%@ taglib uri="http://www.tonbeller.com/jpivot" prefix="jp"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jstl/core"%>


<jp:mondrianQuery queryName="ResumoLigacaoEconomia" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select NON EMPTY {[AnoMesReferencia]} ON COLUMNS,
  NON EMPTY Crossjoin({[Categorias.categoria].[Todas]}, Crossjoin({[LigacoesAguaSituacao.ligacaoAguaSituacao].[Todas]}, Crossjoin({[LigacoesEsgotoSituacao.ligacaoEsgotoSituacao].[Todas]}, {[Measures].[Quantidade Ligações], [Measures].[Quantidade Economias]}))) ON ROWS
from [ResumoLigacaoEconomia]

</jp:mondrianQuery>

<jp:mondrianQuery queryName="ResumoConsumoAgua" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select NON EMPTY {[AnoMesReferencia]} ON COLUMNS,
  NON EMPTY Crossjoin({[GerenciasRegionais.gerenciaRegional].[Todas]}, Crossjoin({[Localidades.localidade].[Todas]}, Crossjoin({[Categorias.categoria].[Todas]}, Crossjoin({[LigacoesEsgotoSituacao.ligacaoEsgotoSituacao].[Todas]}, {[Measures].[Quantidade Ligações], [Measures].[Quantidade Economias], [Measures].[Consumo Excedente], [Measures].[ConsumoMinimo], [Measures].[Consumo Total]})))) ON ROWS
from [ResumoConsumoAgua]

</jp:mondrianQuery>

<jp:mondrianQuery queryName="ResumoLeituraAnormalidade" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select NON EMPTY {[AnoMesReferencia]} ON COLUMNS,
  NON EMPTY {([GerenciasRegionais.gerenciaRegional].[Todas], [Localidades.localidade].[Todas], [LeituraAnormalidade.leituraAnormalidade].[Todos], [Measures].[Quantidade Leituras])} ON ROWS
from [ResumoLeituraAnormalidade]


</jp:mondrianQuery>

<jp:mondrianQuery queryName="ResumoHidrometro" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="gcom_olap"
	jdbcPassword="ol@p"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select NON EMPTY {([Measures].[Quantidade Hidrometros], [AnoMesReferencia.anoMesReferencia].[Todos])} ON COLUMNS,
  NON EMPTY {([LocalArmazanagem.localArmazenagem].[Todos], [HidrometroMarca.hidrometroMarca].[Todas], [HidrometroSituacao.hidrometroSituacao].[Todas])} ON ROWS
from [ResumoHidrometro]

</jp:mondrianQuery>

<jp:mondrianQuery queryName="ResumoInstalacaoHidrometro" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select NON EMPTY {[AnoMesReferencia]} ON COLUMNS,
  NON EMPTY Crossjoin({[GerenciasRegionais.gerenciaRegional].[Todas]}, Crossjoin({[Localidades.localidade].[Todas]}, {[Measures].[Instalados no Ramal], [Measures].[Substituidos no Ramal], [Measures].[Retirados do Ramal], [Measures].[Instalados no Poco], [Measures].[Substituidos no Poco], [Measures].[Retirados do Poco]})) ON ROWS
from [ResumoInstalacaoHidrometro]
</jp:mondrianQuery>


<jp:mondrianQuery queryName="ResumoParcelamento" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select NON EMPTY {[AnoMesReferencia]} ON COLUMNS,
  NON EMPTY Crossjoin({[GerenciasRegionais.gerenciaRegional].[Todas]}, Crossjoin({[Localidades.localidade].[Todas]}, {[Measures].[Quantidade Parcelamentos], [Measures].[Quantidade Contas], [Measures].[Valor Contas], [Measures].[Valor Total Parcelado]})) ON ROWS
from [ResumoParcelamento]
</jp:mondrianQuery>


<%--<jp:mondrianQuery queryName="ResumoFaturamentoOutros" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select NON EMPTY {[Measures].[Quantidade Documentos Faturados], [Measures].[Valor Documentos Faturados]} ON COLUMNS,
  NON EMPTY Crossjoin({[DocumentoTipo]}, Crossjoin({[FinanciamentoTipo]}, {[LancamentoItemContabil]})) ON ROWS
from [ResumoFaturamentoOutros] 
</jp:mondrianQuery> --%>


<%--<jp:mondrianQuery queryName="ResumoFaturamentoCredito" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select NON EMPTY {[Measures].[Quantidade Documentos Faturados], [Measures].[Valor Documentos Faturados]} ON COLUMNS,
  NON EMPTY Crossjoin({[LancamentoItemContabil]}, {[CreditoOrigem]}) ON ROWS
from [ResumoFaturamentoCredito] 
</jp:mondrianQuery>--%>

<jp:mondrianQuery queryName="ResumoFaturamentoAguaEsgoto" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select NON EMPTY {[Measures].[Quantidade Contas Emitidas], [Measures].[Valor Faturado Agua], [Measures].[Valor Faturado Esgoto], [Measures].[Volume Faturado Agua], [Measures].[Volume Faturado Esgoto]} ON COLUMNS,
  NON EMPTY Crossjoin({[AnoMesReferencia]}, Crossjoin({[GerenciasRegionais]}, Crossjoin({[Localidades]}, Crossjoin({SetoresComerciais}, Crossjoin({Quadras}, Crossjoin({Categorias}, Crossjoin({LigacoesAguaSituacao}, {LigacoesEsgotoSituacao}))))))) ON ROWS
from [ResumoFaturamentoAguaEsgoto]
</jp:mondrianQuery>

<jp:mondrianQuery queryName="ResumoArrecadacaoAguaEsgoto" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select NON EMPTY {[Measures].[Quantidade Contas], [Measures].[Valor Agua], [Measures].[Valor Esgoto], [Measures].[Valor Nao Identificado]} ON COLUMNS,
  NON EMPTY Crossjoin({[AnoMesReferencia]}, Crossjoin({[GerenciasRegionais]}, Crossjoin({[Localidades]}, Crossjoin({SetoresComerciais}, Crossjoin({Quadras}, Crossjoin({Categorias}, Crossjoin({LigacoesAguaSituacao}, {LigacoesEsgotoSituacao}))))))) ON ROWS
from [ResumoArrecadacaoAguaEsgoto] 
</jp:mondrianQuery>

<jp:mondrianQuery queryName="ResumoArrecadacaoCredito" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select NON EMPTY {[Measures].[Valor Documentos Recebidos]} ON COLUMNS,
  NON EMPTY Crossjoin({CreditoOrigem}, {LancamentoItemContabil}) ON ROWS
from [ResumoArrecadacaoCredito] 
</jp:mondrianQuery>

<jp:mondrianQuery queryName="ResumoArrecadacaoOutros" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select NON EMPTY {[Measures].[Valor Documentos Recebidos]} ON COLUMNS,
  NON EMPTY Crossjoin({FinanciamentoTipo}, {LancamentoItemContabil}) ON ROWS
from [ResumoArrecadacaoOutros] 
</jp:mondrianQuery> 

<jp:mondrianQuery queryName="ResumoFaturamento" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select NON EMPTY {[AnoMesReferencia]} ON COLUMNS,
  NON EMPTY Crossjoin({[GerenciasRegionais.gerenciaRegional].[Todas]}, Crossjoin({[Localidades.localidade].[Todas]}, {[Measures].[Quantidade Contas Emitidas], [Measures].[Volume Faturado Agua], [Measures].[Volume Faturado Esgoto], [Measures].[Valor Faturado Agua], [Measures].[Valor Faturado Esgoto], [Measures].[Valor Documentos Faturados Outros], [Measures].[Valor Documentos Faturados Credito], [Measures].[Total Cobrado nas Contas]})) ON ROWS
from [ResumoFaturamento]
</jp:mondrianQuery>

<jp:mondrianQuery queryName="ResumoArrecadacao" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select NON EMPTY {[AnoMesReferencia]} ON COLUMNS,
  NON EMPTY Crossjoin({[GerenciasRegionais.gerenciaRegional].[Todas]}, Crossjoin({[Localidades.localidade].[Todas]}, Crossjoin({[Categorias.categoria].[Todas]}, Crossjoin({[ImoveisPerfil.imovelPerfil].[Todos]}, Crossjoin({[DocumentoTipo.documentoTipo].[Todos]}, {[Measures].[Quantidade Contas], [Measures].[Valor Agua], [Measures].[Valor Esgoto], [Measures].[Valor Documentos Recebidos Outros], [Measures].[Valor Documentos Recebidos Credito], [Measures].[Valor Nao Identificado], [Measures].[Total do Valor de Pagamentos]}))))) ON ROWS
from [ResumoArrecadacao]

</jp:mondrianQuery>

<jp:mondrianQuery queryName="ResumoRegistroAtendimento" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select NON EMPTY {[AnoMesReferencia]} ON COLUMNS,
  NON EMPTY Crossjoin({[GerenciasRegionais.gerenciaRegional].[Todas]}, Crossjoin({[Localidades.localidade].[Todas]}, Crossjoin({[SolicitacaoTipo]}, Crossjoin({[SolicitacaoTipoEspecificacao]}, {[Measures].[Quantidade RAs Geradas], [Measures].[Quantidade RAS Pendentes], [Measures].[Quantidade RAS Encerradas], [Measures].[Quantidade RAS Bloqueadas]})))) ON ROWS
from [ResumoRegistroAtendimento]
</jp:mondrianQuery>

<jp:mondrianQuery queryName="ResumoIndicadorLigacaoEconomia" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select NON EMPTY {[MesReferencia.Mesreferencia].[Todos]} ON COLUMNS,
  NON EMPTY Crossjoin({[GerenciasRegionais.gerenciaRegional].[Todas]}, Crossjoin({[Localidades.localidade].[Todas]}, Crossjoin({[Measures].[Indice de Crescimento de Ligacoes Agua(%)], [Measures].[Indice de Crescimento de Ligacoes Esgoto(%)], [Measures].[Indice de Crescimento de Economias Agua(%)], [Measures].[Indice de Crescimento de Economias Esgoto(%)]}, {[AnoReferencia.Anoreferencia].[Todos]}))) ON ROWS
from [ResumoIndicadorLigacaoEconomia]
</jp:mondrianQuery>


<jp:mondrianQuery queryName="ResumoIndicadorDesempenhoMicromedicao" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select NON EMPTY {[MesReferencia.Mesreferencia].[Todos]} ON COLUMNS,
  NON EMPTY Crossjoin({[GerenciasRegionais.gerenciaRegional].[Todas]}, Crossjoin({[Localidades.localidade].[Todas]}, Crossjoin({[Measures].[Indice de Medicao de Consumo - Nominal(%)], [Measures].[Indice de Medicao de Consumo - Efetivo(%)], [Measures].[Eficiencia da Medicao de Consumo(%)], [Measures].[Eficiencia da Leitura(%)], [Measures].[Percentual de Hidrometros com Anormalidade(%)], [Measures].[Volume Medio das Ligacoes com Hidrometro - Consumo Real(M3)], [Measures].[Volume Medio das Ligacoes com Hidrometro - Consumo Estimado(M3)], [Measures].[Volume Consumido por Ligacao(M3)], [Measures].[Volume Consumido por Economia(M3)], [Measures].[Percentual de Volume com Hidrometro - Consumo Real(%)], [Measures].[Percentual de Volume com Hidrometro - Consumo Estimado(%)]}, {[AnoReferencia.Anoreferencia].[Todos]}))) ON ROWS
from [ResumoIndicadorDesempenhoMicromedicao]
</jp:mondrianQuery>

<%--<jp:mondrianQuery queryName="ResumoMetas" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select NON EMPTY {[Measures].[Quantidade Ligacoes Cadastradas], [Measures].[Quantidade Ligacoes Cortadas], [Measures].[Quantidade Ligacoes Suprimidas], [Measures].[Indice1], [Measures].[Quantidade Ligacoes Ativas], [Measures].[Quantidade Ligacoes Ativas Debito 3m], [Measures].[Indice2], [Measures].[Quantidade Ligacoes Consumo Medido], [Measures].[Quantidade Ligacoes Consumo Ate 5m3], [Measures].[Indice3], [Measures].[Quantidade Ligacoes Consumo Nao Medido], [Measures].[Indice4], [Measures].[Quantidade Ligacoes Consumo Media], [Measures].[Indice5], [Measures].[Indice6], [Measures].[Quantidade Economias]} ON COLUMNS,
  NON EMPTY Crossjoin({[AnoMesReferencia].[Todos]}, [Localidades].[Todas]) ON ROWS
from [ResumoMetas]
</jp:mondrianQuery>  





<jp:mondrianQuery queryName="ResumoSituacaoEspecialFaturamento"
	dynLocale="pt" 	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select {[Measures].[Quantidade de Imóveis]} ON COLUMNS,
  {[LigacoesAguaSituacao.ligacaoAguaSituacao].[Todas Situações de Água]} ON ROWS
from [ResumoSituacaoEspecialFaturamento]

</jp:mondrianQuery>


<jp:mondrianQuery queryName="ResumoAnormalidadesConsumo" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select {[Measures].[QuantidadeDeLigacoes], [Measures].[Percentual]} ON COLUMNS,
  {([LigacaoTipo.ligacaoTipo].[Todas Ligações Tipo], [ConsumoAnormalidades.consumoAnormalidades].[Todos Consumos Anormalidade])} ON ROWS
from [ResumoAnormalidadesConsumo]

</jp:mondrianQuery>


<jp:mondrianQuery queryName="ResumoAnormalidadesLeitura" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select {[Measures].[QuantidadeDeMedicoes], [Measures].[Percentual]} ON COLUMNS,
  Hierarchize({([MedicaoTipo.medicaoTipo].[All MedicaoTipo.medicaoTipos], [LeituraAnormalidade.leituraAnormalidade].[Todas Leituras Anormalidades])}) ON ROWS
from [ResumoAnormalidadesLeitura]

</jp:mondrianQuery>


<jp:mondrianQuery queryName="ResumoPendencia" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select {[Measures].[Quantidade de Documentos], [Measures].[Valor Débito], [Measures].[Quantidade de Ligações]} ON COLUMNS,
  Hierarchize({([Categorias.categoria].[Todas Categorias], [LigacoesAguaSituacao.ligacaoAguaSituacao].[Todas Situações de Água], [LigacoesEsgotoSituacao.ligacaoEsgotoSituacao].[Todas Situações de Esgoto])}) ON ROWS
from [ResumoPendencia]

</jp:mondrianQuery>

<jp:mondrianQuery queryName="ResumoRegistroAtendimento" dynLocale="pt"
	jdbcDriver="org.postgresql.Driver" jdbcUser="postgres"
	jdbcPassword="001100"
	jdbcUrl="jdbc:postgresql://127.0.0.1/gsan_gerencial"
	catalogUri="/WEB-INF/queries/schemaGcomGerencial2.xml" id="query01">

select NON EMPTY {[Measures].[Quantidade RAs Geradas] , [Measures].[Quantidade RAS Pendentes] , [Measures].[Quantidade RAS Bloqueadas] , [Measures].[Quantidade RAS Encerradas]} ON COLUMNS,
  NON EMPTY Crossjoin({[AnoMesReferencia]}, Crossjoin({[GerenciasRegionais]}, Crossjoin({[Localidades]}, Crossjoin({SetoresComerciais}, Crossjoin({Quadras}, Crossjoin({Categorias}, Crossjoin({SolicitacaoTipoEspecificacao}, {SolicitacaoTipo}))))))) ON ROWS
from [ResumoRegistroAtendimento] 
</jp:mondrianQuery>

--%>

<%--<c:set var="parametro" scope="request">ResumoPendencia</c:set>--%>


<%
String parametro = request.getParameter("parametro");

%>

<jp:chooseQuery id="query01" queryName="<%=parametro %>"/>

<c:set var="title01" scope="session">OLAP Gcom</c:set>


